<?xml version="1.0" encoding="utf-8"?>
<s:BorderContainer xmlns:fx="http://ns.adobe.com/mxml/2009" 
				   xmlns:s="library://ns.adobe.com/flex/spark" backgroundAlpha=".75" mouseOver="clearTimeout(tm)" mouseOut="tm=setTimeout(hideMessage, 1000);"
				   xmlns:mx="library://ns.adobe.com/flex/mx" width="250" minHeight="20" creationComplete="initComp()">
	<fx:Script>
		<![CDATA[
			import flash.utils.clearTimeout;
			
			import mx.collections.ArrayCollection;
			import mx.controls.Alert;
			import mx.events.CollectionEvent;
			
			[Bindable] public var dp:ArrayCollection;
			private var tm:uint;
			private var slide:Boolean=true;
			
			private function initComp():void{
				dp.addEventListener(CollectionEvent.COLLECTION_CHANGE, showBox);
				this.addEventListener("delMsg",deleteMessage);
				hideMessage();
			}
			
			private function showBox(evt:CollectionEvent):void{
				//if(showlst.isPlaying)return;
				//if(hidelst.isPlaying)return;
				
				hidelst.stop();
				showlst.stop();
				clearTimeout(tm);
				if(slide){
					showlst.play();
				}
				else{
					lst.bottom=0;
					slide=true;
				}
				tm = setTimeout(hideMessage, 4000);
			}
			private function hideMessage():void{
				hidelst.play();
			}
			public function deleteMessage(evt:Event):void{
				slide=false;
				global.messageList.removeItemAt(lst.selectedIndex);
				if(global.messageList.length==0)hideMessage();
			}
		]]>
	</fx:Script>
	<fx:Declarations>
		<s:Animate id="hidelst" target="{this}" duration="250">
			<s:SimpleMotionPath property="bottom" valueFrom="0" valueTo="{-this.height}">
			</s:SimpleMotionPath>
		</s:Animate>
		
		<s:Animate id="showlst" target="{this}" duration="300">
			<s:SimpleMotionPath property="bottom" valueFrom="{-this.height}" valueTo="0">
			</s:SimpleMotionPath>
		</s:Animate>
	</fx:Declarations>
	
	<s:List id="lst" verticalScrollPolicy="off" horizontalScrollPolicy="off" width="100%" bottom="0" contentBackgroundAlpha="0" borderVisible="false"
			dataProvider="{dp}" labelField="msg" itemRenderer="renderers.MessageRenderer">
		<s:layout>
			<s:VerticalLayout useVirtualLayout="false" variableRowHeight="true" requestedMaxRowCount="{global.messageLimit}"/>
		</s:layout>		
	</s:List>
</s:BorderContainer>
