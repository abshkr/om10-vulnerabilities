<?xml version="1.0" encoding="utf-8"?>
<s:GridItemEditor xmlns:fx="http://ns.adobe.com/mxml/2009" 
				  xmlns:s="library://ns.adobe.com/flex/spark"   
				  xmlns:mx="library://ns.adobe.com/flex/mx"
				  creationComplete="creationCompleteHandler(event)">
	
	<fx:Script>
		<![CDATA[
			import dm.DM;
			import dm.utils.tools;
			
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			
			import spark.events.IndexChangeEvent;
			
			[Bindable] private var myDataProvider:ArrayCollection = new ArrayCollection
				(
					[
						{id:'0', code:'0', name:'Unlocked', icon:'assets/icons/unlocked.png'}
						, {id:'1', code:'1', name:'Locked', icon:'assets/icons/lock.png'}
					]
				);
			
			public var isLocked:Boolean=false;
			public var oldCode:String;
			
			public function creationCompleteHandler(event:FlexEvent):void
			{
				oldCode = data[column.dataField];
				if ( data[column.dataField] == "1" )
				{
					isLocked = true;
				}
				else
				{
					isLocked = false;
				}
			}
			
			override public function set value(newValue:Object):void 
			{
				//this.getMyDataProvider();
				ddl.selectedIndex=0;
				for(var i:int=0;i <myDataProvider.length;i++)
				{
					if (myDataProvider[i].code == data[column.dataField])
					{
						ddl.selectedIndex = i;
						break;
					}
				}
			}
			
			override public function get value():Object 
			{
				if (ddl.selectedIndex > -1)
				{
					return myDataProvider[ddl.selectedIndex].code;
				}
				else
				{
					if ( myDataProvider != null && myDataProvider.length>0 )
					{
						return oldCode;
					}
					else
					{
						return "0";
					}
				}
			}
			
			override public function setFocus():void 
			{
				ddl.setFocus();
			}
			
			
			protected function droplist_changeHandler(event:IndexChangeEvent):void
			{
				trace ("droplist_changeHandler", isLocked, ddl.selectedIndex, ddl.selectedItem.name, data[column.dataField]);
			}
			
			
		]]>
	</fx:Script>
	<s:ComboBox id="ddl" dataProvider="{myDataProvider}" borderVisible="false"
				skinClass="skins.DKI_IconComboBox_Skin" labelField="code"
				change="droplist_changeHandler(event)" 
				itemRenderer="renderers.ImageItemRenderer"
				width="100%"/> 
</s:GridItemEditor>