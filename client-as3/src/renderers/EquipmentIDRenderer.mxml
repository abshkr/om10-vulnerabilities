<?xml version="1.0" encoding="utf-8"?>
<s:GridItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009"
					xmlns:s="library://ns.adobe.com/flex/spark"
					xmlns:mx="library://ns.adobe.com/flex/mx" clipAndEnableScrolling="true"
					xmlns:components="components.*"
					xmlns:dm="dm.*"
					>
	
	<fx:Script>
		<![CDATA[
			import dm.utils.tools;
			import mx.collections.ArrayCollection;
			import spark.events.IndexChangeEvent;
			
			public var readOnly:Boolean = false;
			
			override public function prepare(hasBeenRecycled:Boolean):void
			{
				//trace(owner);
				if (data)
				{
					var tmp:String = String(data[column.dataField]);
					var idx:int = -1;
					var temp:Object = DM.ManualTransactions;
					if (temp.equipments == null) return;
					idx = tools.getItemIndexFromCode(tmp, temp.equipments, "EQPT_CODE");
					if (readOnly && idx == -1)
					{
						idx = DM.ManualTransactions.equipments.length;
					}
					listData.selectedIndex = idx;
					if (readOnly && DM.ManualTransactions.equipments[idx])
					{
						listLabel.text = DM.ManualTransactions.equipments[idx].EQPT_CODE;
					}
				}
			}
			
			protected function droplist_changeHandler(event:IndexChangeEvent):void
			{
				data[column.dataField]=listData.selectedItem.EQPT_CODE;
				//var parnt:DataGrid = owner as DataGrid;
				//(parnt.dataProvider as ArrayCollection).refresh();
			}
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<dm:DM/>
	</fx:Declarations>
	
	<s:DropDownList id="listData" top="0" left="0" bottom="0" right="0" includeInLayout="{!readOnly}" visible="{!readOnly}"
					dataProvider="{DM.ManualTransactions.equipments}"
					labelField="EQPT_CODE" prompt="Select Compartment ID" change="droplist_changeHandler(event)" useVirtualLayout="false"/>
	
	<s:Label id="listLabel" top="2" left="2" bottom="2" right="2" verticalAlign="middle" includeInLayout="{readOnly}" visible="{readOnly}" backgroundAlpha="0"/>
	
</s:GridItemRenderer>
