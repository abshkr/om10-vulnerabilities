<?xml version="1.0" encoding="utf-8"?>
<s:VGroup xmlns:fx="http://ns.adobe.com/mxml/2009"
		 xmlns:s="library://ns.adobe.com/flex/spark"
		 xmlns:mx="library://ns.adobe.com/flex/mx"
		 currentState="normal"
		 width="100%" height="100%" xmlns:components="components.*" xmlns:dm="dm.*" xmlns:controllers="controllers.*">
	<s:states>
		<s:State name="widget"/>
		<s:State name="normal"/>
		<s:State name="edit"/>
		<s:State name="create"/>
	</s:states>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<dm:DM id="dm"/>
		<controllers:C_MovementReasons id="controller" view="{this}"/>
	</fx:Declarations>
	<s:Panel id="mainPanel" width="100%" height="100%" skinClass="skins.WidgetPanelSkin"
			 title="Reason Codes for Special Movements"
			 skinClass.widget="skins.NullSkin">
		<s:layout>
			<s:VerticalLayout/>
		</s:layout>
		<s:HGroup width="100%" paddingBottom="2" paddingLeft="2" paddingRight="2" paddingTop="2" enabled="true" enabled.create="false"
				  verticalAlign="middle">
			<s:Label id="fltTypeLabel" includeIn="create,edit,normal" text="{resourceManager.getString('default','MOVREASON.LABEL.NOM_TYPE')}" textAlign="right"/>
			<s:DropDownList width="120" id="fltType" prompt="{resourceManager.getString('default','MOVREASON.PROMPT.NOM_TYPE')}" contentBackgroundAlpha="1" labelField="MOVITEM_TYPE_NAME" 
							dataProvider="{DM.MovementReasons.types}" change="controller.refreshMainFilter()" selectedIndex="@{C_MovementReasons.TYPE_INDEX}"/>
			<s:Label id="fltMoveTypeLabel" includeIn="create,edit,normal" text="{resourceManager.getString('default','MOVREASON.LABEL.MOV_TYPE')}" textAlign="right"/>
			<components:DKI_ValidatorInput id="fltMoveType" includeIn="create,edit,normal" width="150" prompt="{resourceManager.getString('default','MOVREASON.LABEL.MOV_TYPE')}" width.widget="60" change="controller.refreshMainFilter()" text="@{C_MovementReasons.MOVETYPE_STRING}"/>
			<s:Label id="fltReasonCodeLabel" includeIn="create,edit,normal" text="{resourceManager.getString('default','MOVREASON.LABEL.REASON_CODE')}" textAlign="right"/>
			<components:DKI_ValidatorInput id="fltReasonCode" includeIn="create,edit,normal" width="150" prompt="{resourceManager.getString('default','MOVREASON.LABEL.REASON_CODE')}" width.widget="60" change="controller.refreshMainFilter()" text="@{C_MovementReasons.REASONCODE_STRING}"/>
			<s:Label id="fltActionLabel" includeIn="create,edit,normal" text="{resourceManager.getString('default','MOVREASON.LABEL.BIZ_PROC')}" textAlign="right"/>
			<components:DKI_ValidatorInput id="fltAction" prompt="{resourceManager.getString('default','MOVREASON.LABEL.BIZ_PROC')}" contentBackgroundAlpha="1" width="100%" change="controller.refreshMainFilter()" text="@{C_MovementReasons.ACTION_STRING}"/>
			<components:DKI_Button type="refresh"  id="btnClear" label="{resourceManager.getString('default','CLEAR')}" click="controller.clearMainFilter()"/>
			<components:DKI_Button type="create" id="btnCreate" includeIn="normal" label="{resourceManager.getString('default','CREATE')}" enabled="{controller.canCreate}" click.normal="controller.prepareForCreate();"/>
		</s:HGroup>
		<s:DataGrid enabled="true" enabled.create="false" 
					id="mainList" width="100%" height="100%" dataProvider="{DM.MovementReasons}" 
					creationComplete="controller.sortByID()"
					selectionChange="controller.prepareForUpdate()" selectionChange.widget="null">
			<s:columns>
				<s:ArrayList>
					<s:GridColumn width="40"  dataField="clnId"            headerText="{resourceManager.getString('default','MOVREASON.LABEL.REASON_ID')}" sortDescending="false" visible="false"/>
					<s:GridColumn width="130" dataField="clnAction"        headerText="{resourceManager.getString('default','MOVREASON.LABEL.REASON_DESC')}"/>
					<s:GridColumn width="120"  dataField="clnType"          headerText="{resourceManager.getString('default','MOVREASON.LABEL.NOM_TYPE')}"/>
					<s:GridColumn width="200" dataField="clnMoveTypeOri"   headerText="{resourceManager.getString('default','MOVREASON.LABEL.ORIG_MOV_TYPE')}"/>
					<s:GridColumn width="200" dataField="clnReasonCodeOri" headerText="{resourceManager.getString('default','MOVREASON.LABEL.ORIG_REASON_CODE')}"/>
					<s:GridColumn width="200" dataField="clnMoveTypeRev"   headerText="{resourceManager.getString('default','MOVREASON.LABEL.REVS_MOV_TYPE')}"/>
					<s:GridColumn width="200" dataField="clnReasonCodeRev" headerText="{resourceManager.getString('default','MOVREASON.LABEL.REVS_REASON_CODE')}"/>
					<!--<s:GridColumn width="100" dataField="clnFlag"          headerText="{resourceManager.getString('default','MOVREASON.LABEL.FLAG_SEND_TO_HOST')}" visible.widget="false"/>-->
					<s:GridColumn width="200" dataField="clnStatus"        headerText="{resourceManager.getString('default','MOVREASON.LABEL.REASON_STATUS')}" visible.widget="false"/>
				</s:ArrayList>
			</s:columns>
			<!--
			CREATE TABLE MOV_REASONS
			(
			MR_ID                 NUMBER (9),
			MR_ACTION             VARCHAR2 (128 Byte) NOT NULL,
			MR_TYPE               VARCHAR2 (1 Byte),
			MR_MOV_TYPE_ORI       VARCHAR2 (4 Byte),
			MR_REASON_CODE_ORI    VARCHAR2 (4 Byte),
			MR_MOV_TYPE_REV       VARCHAR2 (4 Byte),
			MR_REASON_CODE_REV    VARCHAR2 (4 Byte),
			MR_FLAG               NUMBER (1),
			CONSTRAINT PK_MOV_REASONS
			PRIMARY KEY(MR_ID)
			);
			
			select MR_ID, MR_ACTION, MR_TYPE, MR_MOV_TYPE_ORI, MR_REASON_CODE_ORI, MR_MOV_TYPE_REV, MR_REASON_CODE_REV, MR_FLAG 
			from MOV_REASONS 
			where ....
			
			Note: value from field txtMovementTypeSearch needs to be compared with either MR_MOV_TYPE_ORI or MR_MOV_TYPE_REV, 
			and value from field txtReasonCodeSearch needs to be compared with either MR_REASON_CODE_ORI or MR_REASON_CODE_REV
			
			The following is the mapping between table columns and grid and form fields:
			========================================================================================
			Table Column                    Grid Column                    Form Field
			========================================================================================
			MR_ID                           clnId                          frmId
			MR_ACTION                       clnAction                      frmAction
			MR_TYPE                         clnType                        frmType
			MR_MOV_TYPE_ORI                 clnMoveTypeOri                 frmMoveTypeOri
			MR_REASON_CODE_ORI              clnReasonCodeOri               frmReasonCodeOri
			MR_MOV_TYPE_REV                 clnMoveTypeRev                 frmMoveTypeRev
			MR_REASON_CODE_REV              clnReasonCodeRev               frmReasonCodeRev
			MR_FLAG                         clnFlag                        frmFlag
			========================================================================================
			
			-->
		</s:DataGrid>
	</s:Panel>
	<s:Panel id="detailsPanel" includeIn="edit,create" width="100%" height="300" 
			 skinClass="skins.WidgetPanelSkin">
		<s:VGroup width="100%" height="100%" enabled="{mainList.selectedItem.payload.MR_FLAG!=2}">
			<s:Spacer width="100%" height="5"/>
			<s:HGroup width="100%" gap="20" paddingBottom="2" paddingLeft="5" paddingRight="2"
					  paddingTop="2" verticalAlign="middle">
				<s:Label id="frmIdLabel" text="{resourceManager.getString('default','MOVREASON.LABEL.REASON_ID')+':'}" textAlign="right" width="150"/>
				<s:Label id="frmId" width="100" text="{DM.MovementReasons.nextID}" fontWeight="bold"/>
				<s:Spacer width="50"/>
				<s:Label id="frmTypeLabel" text="{resourceManager.getString('default','MOVREASON.LABEL.NOM_TYPE')}" textAlign="right"/>
				<s:DropDownList id="frmType" width="120" prompt="{resourceManager.getString('default','MOVREASON.PROMPT.NOM_TYPE')}" dataProvider="{DM.MovementReasons.types}" labelField="MOVITEM_TYPE_NAME"/>
				<s:Spacer width="50"/>
				<s:CheckBox label="{resourceManager.getString('default','MOVREASON.LABEL.FLAG_SEND_TO_HOST')}" fontWeight="bold" id="frmFlag" selected="true"/>
			</s:HGroup>
			<s:Spacer width="100%" height="5"/>
			<s:HGroup width="100%" gap="10" paddingBottom="2" paddingLeft="5" paddingRight="2"
					  paddingTop="2" verticalAlign="middle">
				<s:Label id="frmActionLabel" width="150" text="{resourceManager.getString('default','MOVREASON.LABEL.BIZ_PROC')}" textAlign="right"/>
				<components:DKI_ValidatorInput maxChars="128" id="frmAction" width="620" prompt="{resourceManager.getString('default','MOVREASON.LABEL.BIZ_PROC')}"/>
			</s:HGroup>
			<s:Spacer width="100%" height="5"/>
			<s:HGroup width="100%" gap="10" paddingBottom="2" paddingLeft="5" paddingRight="2"
					  paddingTop="2" verticalAlign="middle">
				<s:Label id="frmMoveTypeOriLabel" width="150" text="{resourceManager.getString('default','MOVREASON.LABEL.ORIG_MOV_TYPE')}" textAlign="right"/>
				<components:DKI_ValidatorInput maxChars="4" id="frmMoveTypeOri" width="200" prompt="{resourceManager.getString('default','MOVREASON.LABEL.ORIG_MOV_TYPE')}" enabled="{frmFlag.selected}"/>
				<s:Spacer width="50"/>
				<s:Label id="frmReasonCodeOriLabel" width="150" text="{resourceManager.getString('default','MOVREASON.LABEL.ORIG_REASON_CODE')}" textAlign="right"/>
				<components:DKI_ValidatorInput maxChars="4" id="frmReasonCodeOri" width="200" prompt="{resourceManager.getString('default','MOVREASON.LABEL.ORIG_REASON_CODE')}" enabled="{frmFlag.selected}"/>
			</s:HGroup>
			<s:Spacer width="100%" height="5"/>
			<s:HGroup width="100%" gap="10" paddingBottom="2" paddingLeft="5" paddingRight="2"
					  paddingTop="2" verticalAlign="middle">
				<s:Label id="frmMoveTypeRevLabel" width="150" text="{resourceManager.getString('default','MOVREASON.LABEL.REVS_MOV_TYPE')}" textAlign="right"/>
				<components:DKI_ValidatorInput maxChars="4" id="frmMoveTypeRev" width="200" prompt="{resourceManager.getString('default','MOVREASON.LABEL.REVS_MOV_TYPE')}" enabled="{frmFlag.selected}"/>
				<s:Spacer width="50"/>
				<s:Label id="frmReasonCodeRevLabel" width="150" text="{resourceManager.getString('default','MOVREASON.LABEL.REVS_REASON_CODE')}" textAlign="right"/>
				<components:DKI_ValidatorInput maxChars="4" id="frmReasonCodeRev" width="200" prompt="{resourceManager.getString('default','MOVREASON.LABEL.REVS_REASON_CODE')}" enabled="{frmFlag.selected}"/>
			</s:HGroup>
			
			<s:Spacer height="20" />
			
			<s:HGroup width="100%" gap="5" paddingBottom="4" 
					  paddingRight="5" paddingTop="4">
				<s:Spacer width="100%"/>
				<components:DKI_Button id="btnDelete" label="{resourceManager.getString('default','DELETE')}" height="100%" includeIn="edit" type="delete" click="controller.remove();" enabled="{controller.canDelete}"/>
				<components:DKI_Button id="btnSave" label.create="{resourceManager.getString('default','SAVE')}" label="{resourceManager.getString('default','UPDATE')}" height="100%" includeIn="edit,create" 
									   type.create="create" click.create="controller.create();" 
									   type.edit="edit"     click.edit="controller.update();" enabled="false"
									   enabled.edit="{controller.canUpdate}" enabled.create="{controller.canCreate}"/>
				<components:DKI_Button id="btnCancel" label="{resourceManager.getString('default','CANCEL')}" height="100%" enabled="true" type="cancel" click="currentState = 'normal'"/>
			</s:HGroup>
		</s:VGroup>
		
	</s:Panel>
</s:VGroup>
